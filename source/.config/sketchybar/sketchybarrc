PLUGIN_DIR="$CONFIG_DIR/plugins"

bar=(
    position=top
    height=36
    y_offset=8
    margin=12
    color=0xCC303446
    corner_radius=8
    blur_radius=40
    shadow=on
)
sketchybar --bar "${bar[@]}"

default=(
    background.height=24
    background.color=0xFF414559
    background.corner_radius=8
    icon.font="NotoSansM Nerd Font Mono:Bold:16.0"
    icon.padding_left=12
    icon.padding_right=2
    icon.color=0xFF303446
    label.font="NotoSansM Nerd Font Mono:Bold:14.0"
    label.padding_left=12
    label.padding_right=12
    padding_left=4
    padding_right=4
)
sketchybar --default "${default[@]}"

SPACE_ICONS=("1" "2" "3" "4")
for i in "${!SPACE_ICONS[@]}"
do
    sid="$(($i+1))"
    space=(
        icon.color=0xFFFFFFFF
        space="$sid"
        width=20
        background.color=0x00ffffff
        background.corner_radius=4
        label.drawing=off
        icon.padding_left=0
        icon.padding_right=0
        script="$PLUGIN_DIR/space.sh"
    )
    sketchybar --add space space."$sid" left --set space."$sid" "${space[@]}"
done

sketchybar --add item front_app left \
           --set front_app icon.drawing=off script="$PLUGIN_DIR/front_app.sh" \
           --subscribe front_app front_app_switched

sketchybar --add item clock right \
           --set clock icon.drawing=off update_freq=10 script="$PLUGIN_DIR/clock.sh"

sketchybar --add item volume right \
           --set volume icon.color=0xFF81c8be script="$PLUGIN_DIR/volume.sh" \
           --subscribe volume volume_change
           
sketchybar --add item battery right \
           --set battery update_freq=120 icon.color=0xFFe5c890 script="$PLUGIN_DIR/battery.sh" \
           --subscribe battery system_woke power_source_change


sketchybar --update
